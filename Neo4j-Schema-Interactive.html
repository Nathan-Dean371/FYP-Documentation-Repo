<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neo4j Database Schema - Injury Surveillance System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: white;
            margin-bottom: 10px;
            font-size: 32px;
            text-align: center;
        }
        
        .subtitle {
            color: rgba(255,255,255,0.9);
            margin-bottom: 30px;
            font-size: 16px;
            text-align: center;
        }
        
        .schema-canvas {
            background: white;
            border-radius: 16px;
            padding: 60px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }
        
        .legend {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #333;
        }
        
        .legend-node {
            width: 30px;
            height: 30px;
            border-radius: 15px;
            border: 3px solid;
        }
        
        .legend-relationship {
            width: 60px;
            height: 3px;
            background: #666;
            position: relative;
        }
        
        .legend-relationship::after {
            content: '';
            position: absolute;
            right: -5px;
            top: -4px;
            width: 0;
            height: 0;
            border-left: 10px solid #666;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
        }
        
        .graph-container {
            position: relative;
            width: 100%;
            height: 800px;
            background: #fafbfc;
            border-radius: 8px;
            border: 2px solid #e1e4e8;
        }
        
        svg {
            width: 100%;
            height: 100%;
        }
        
        .node {
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .node:hover {
            transform: scale(1.05);
        }
        
        .node-circle {
            fill: white;
            stroke-width: 4;
        }
        
        .node-label {
            font-size: 16px;
            font-weight: 600;
            text-anchor: middle;
            fill: #333;
            pointer-events: none;
        }
        
        .node-properties {
            font-size: 11px;
            text-anchor: middle;
            fill: #666;
            pointer-events: none;
        }
        
        .relationship {
            stroke: #666;
            stroke-width: 3;
            fill: none;
            marker-end: url(#arrowhead);
        }
        
        .relationship-label {
            font-size: 13px;
            font-weight: 600;
            text-anchor: middle;
            fill: #fff;
            pointer-events: none;
        }
        
        .relationship-label-bg {
            fill: #666;
            rx: 4;
        }
        
        .cardinality {
            font-size: 11px;
            fill: #999;
            font-weight: 600;
        }
        
        /* Node type colors */
        .user-node { stroke: #667eea; }
        .player-node { stroke: #4CAF50; }
        .coach-node { stroke: #2196F3; }
        .admin-node { stroke: #9C27B0; }
        .team-node { stroke: #FF9800; }
        .sport-node { stroke: #F44336; }
        .injury-node { stroke: #E91E63; }
        .status-node { stroke: #00BCD4; }
        .org-node { stroke: #795548; }
        
        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 300px;
            display: none;
        }
        
        .info-panel.active {
            display: block;
        }
        
        .info-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .info-section {
            margin-bottom: 15px;
        }
        
        .info-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .property-item {
            font-size: 13px;
            color: #666;
            padding: 4px 0;
            font-family: 'Courier New', monospace;
        }
        
        .property-name {
            color: #667eea;
            font-weight: 600;
        }
        
        .property-type {
            color: #999;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Neo4j Database Schema</h1>
        <p class="subtitle">Injury Surveillance System - Graph Database Structure</p>
        
        <div class="schema-canvas">
            <!-- Legend -->
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-node player-node"></div>
                    <span>Player Node</span>
                </div>
                <div class="legend-item">
                    <div class="legend-node coach-node"></div>
                    <span>Coach Node</span>
                </div>
                <div class="legend-item">
                    <div class="legend-node team-node"></div>
                    <span>Team Node</span>
                </div>
                <div class="legend-item">
                    <div class="legend-node sport-node"></div>
                    <span>Sport Node</span>
                </div>
                <div class="legend-item">
                    <div class="legend-node injury-node"></div>
                    <span>Injury Node</span>
                </div>
                <div class="legend-item">
                    <div class="legend-relationship"></div>
                    <span>Relationship</span>
                </div>
            </div>
            
            <!-- Graph Visualization -->
            <div class="graph-container">
                <svg viewBox="0 0 1200 800">
                    <!-- Define arrowhead marker -->
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" 
                                refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#666" />
                        </marker>
                    </defs>
                    
                    <!-- Relationships (drawn first, so they appear behind nodes) -->
                    
                    <!-- Player -> Team -->
                    <path class="relationship" d="M 200 300 Q 300 250 400 250" />
                    <rect class="relationship-label-bg" x="275" y="235" width="80" height="20" />
                    <text class="relationship-label" x="315" y="249">BELONGS_TO</text>
                    <text class="cardinality" x="220" y="295">*</text>
                    <text class="cardinality" x="380" y="245">*</text>
                    
                    <!-- Team -> Sport -->
                    <path class="relationship" d="M 500 250 L 700 250" />
                    <rect class="relationship-label-bg" x="555" y="235" width="90" height="20" />
                    <text class="relationship-label" x="600" y="249">PARTICIPATES_IN</text>
                    <text class="cardinality" x="520" y="245">*</text>
                    <text class="cardinality" x="680" y="245">1</text>
                    
                    <!-- Coach -> Team -->
                    <path class="relationship" d="M 200 500 Q 300 400 400 350" />
                    <rect class="relationship-label-bg" x="275" y="405" width="70" height="20" />
                    <text class="relationship-label" x="310" y="419">MANAGES</text>
                    <text class="cardinality" x="220" y="495">1</text>
                    <text class="cardinality" x="380" y="355">*</text>
                    
                    <!-- Player -> Injury -->
                    <path class="relationship" d="M 200 350 L 200 550" />
                    <rect class="relationship-label-bg" x="165" y="440" width="70" height="20" />
                    <text class="relationship-label" x="200" y="454">HAS_INJURY</text>
                    <text class="cardinality" x="210" y="365">1</text>
                    <text class="cardinality" x="210" y="540">*</text>
                    
                    <!-- Player -> StatusUpdate -->
                    <path class="relationship" d="M 150 300 Q 50 400 150 500" />
                    <rect class="relationship-label-bg" x="60" y="395" width="80" height="20" />
                    <text class="relationship-label" x="100" y="409">HAD_STATUS</text>
                    <text class="cardinality" x="160" y="315">1</text>
                    <text class="cardinality" x="160" y="490">*</text>
                    
                    <!-- Organization -> Player -->
                    <path class="relationship" d="M 1000 300 Q 700 350 300 300" />
                    <rect class="relationship-label-bg" x="625" y="315" width="75" height="20" />
                    <text class="relationship-label" x="663" y="329">EMPLOYS</text>
                    <text class="cardinality" x="980" y="300">1</text>
                    <text class="cardinality" x="320" y="300">*</text>
                    
                    <!-- Organization -> Coach -->
                    <path class="relationship" d="M 1000 350 Q 700 450 300 500" />
                    <rect class="relationship-label-bg" x="625" y="435" width="75" height="20" />
                    <text class="relationship-label" x="663" y="449">EMPLOYS</text>
                    <text class="cardinality" x="980" y="360">1</text>
                    <text class="cardinality" x="320" y="500">*</text>
                    
                    <!-- Organization -> Team -->
                    <path class="relationship" d="M 950 350 Q 700 300 550 250" />
                    <rect class="relationship-label-bg" x="710" y="280" width="50" height="20" />
                    <text class="relationship-label" x="735" y="294">OWNS</text>
                    <text class="cardinality" x="930" y="355">1</text>
                    <text class="cardinality" x="570" y="255">*</text>
                    
                    <!-- Nodes -->
                    
                    <!-- Player Node -->
                    <g class="node" onclick="showInfo('player')">
                        <circle class="node-circle player-node" cx="200" cy="300" r="70" />
                        <text class="node-label" x="200" y="295">Player</text>
                        <text class="node-properties" x="200" y="310">id, name, email</text>
                        <text class="node-properties" x="200" y="322">status, position</text>
                    </g>
                    
                    <!-- Coach Node -->
                    <g class="node" onclick="showInfo('coach')">
                        <circle class="node-circle coach-node" cx="200" cy="500" r="70" />
                        <text class="node-label" x="200" y="495">Coach</text>
                        <text class="node-properties" x="200" y="510">id, name, email</text>
                        <text class="node-properties" x="200" y="522">phone</text>
                    </g>
                    
                    <!-- Team Node -->
                    <g class="node" onclick="showInfo('team')">
                        <circle class="node-circle team-node" cx="450" cy="250" r="70" />
                        <text class="node-label" x="450" y="245">Team</text>
                        <text class="node-properties" x="450" y="260">id, name</text>
                        <text class="node-properties" x="450" y="272">level, season</text>
                    </g>
                    
                    <!-- Sport Node -->
                    <g class="node" onclick="showInfo('sport')">
                        <circle class="node-circle sport-node" cx="750" cy="250" r="70" />
                        <text class="node-label" x="750" y="245">Sport</text>
                        <text class="node-properties" x="750" y="260">id, name</text>
                        <text class="node-properties" x="750" y="272">category</text>
                    </g>
                    
                    <!-- Injury Node -->
                    <g class="node" onclick="showInfo('injury')">
                        <circle class="node-circle injury-node" cx="200" cy="600" r="70" />
                        <text class="node-label" x="200" y="595">Injury</text>
                        <text class="node-properties" x="200" y="610">id, bodyPart</text>
                        <text class="node-properties" x="200" y="622">severity, type</text>
                    </g>
                    
                    <!-- StatusUpdate Node -->
                    <g class="node" onclick="showInfo('status')">
                        <circle class="node-circle status-node" cx="50" cy="400" r="65" />
                        <text class="node-label" x="50" y="395">StatusUpdate</text>
                        <text class="node-properties" x="50" y="410">status, date</text>
                        <text class="node-properties" x="50" y="422">painLevel</text>
                    </g>
                    
                    <!-- Organization Node -->
                    <g class="node" onclick="showInfo('organization')">
                        <circle class="node-circle org-node" cx="1000" cy="350" r="70" />
                        <text class="node-label" x="1000" y="345">Organization</text>
                        <text class="node-properties" x="1000" y="360">id, name</text>
                        <text class="node-properties" x="1000" y="372">location</text>
                    </g>
                    
                    <!-- Admin Node -->
                    <g class="node" onclick="showInfo('admin')">
                        <circle class="node-circle admin-node" cx="1000" cy="550" r="60" />
                        <text class="node-label" x="1000" y="545">Admin</text>
                        <text class="node-properties" x="1000" y="560">id, name, email</text>
                        <text class="node-properties" x="1000" y="572">role</text>
                    </g>
                    
                    <!-- Admin -> Organization -->
                    <path class="relationship" d="M 1000 490 L 1000 420" />
                    <rect class="relationship-label-bg" x="965" y="445" width="70" height="20" />
                    <text class="relationship-label" x="1000" y="459">ADMINISTERS</text>
                    <text class="cardinality" x="1010" y="480">*</text>
                    <text class="cardinality" x="1010" y="430">1</text>
                </svg>
            </div>
            
            <!-- Info Panel -->
            <div id="infoPanel" class="info-panel">
                <div class="info-title">Select a node</div>
                <div class="info-section">
                    <div class="info-section-title">Click on any node to view details</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const nodeData = {
            player: {
                title: 'Player Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'name', type: 'String', required: true },
                    { name: 'email', type: 'String', required: true, unique: true },
                    { name: 'passwordHash', type: 'String', required: true },
                    { name: 'status', type: 'Enum', required: true, values: ['GREEN', 'ORANGE', 'RED'] },
                    { name: 'position', type: 'String', required: false },
                    { name: 'dateOfBirth', type: 'Date', required: false },
                    { name: 'createdAt', type: 'DateTime', required: true },
                    { name: 'lastStatusUpdate', type: 'DateTime', required: false }
                ],
                relationships: [
                    'BELONGS_TO → Team (many-to-many)',
                    'HAS_INJURY → Injury (one-to-many)',
                    'HAD_STATUS → StatusUpdate (one-to-many)',
                    'MEMBER_OF → Organization (many-to-one)'
                ],
                indexes: ['id', 'email'],
                constraints: ['UNIQUE(id)', 'UNIQUE(email)']
            },
            coach: {
                title: 'Coach Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'name', type: 'String', required: true },
                    { name: 'email', type: 'String', required: true, unique: true },
                    { name: 'passwordHash', type: 'String', required: true },
                    { name: 'phone', type: 'String', required: false },
                    { name: 'createdAt', type: 'DateTime', required: true }
                ],
                relationships: [
                    'MANAGES → Team (one-to-many)',
                    'MEMBER_OF → Organization (many-to-one)'
                ],
                indexes: ['id', 'email'],
                constraints: ['UNIQUE(id)', 'UNIQUE(email)']
            },
            team: {
                title: 'Team Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'name', type: 'String', required: true },
                    { name: 'level', type: 'String', required: false },
                    { name: 'season', type: 'String', required: false },
                    { name: 'createdAt', type: 'DateTime', required: true }
                ],
                relationships: [
                    '← BELONGS_TO - Player (many-to-many)',
                    'PARTICIPATES_IN → Sport (many-to-one)',
                    '← MANAGES - Coach (many-to-one)',
                    'OWNED_BY → Organization (many-to-one)'
                ],
                indexes: ['id', 'name'],
                constraints: ['UNIQUE(id)']
            },
            sport: {
                title: 'Sport Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'name', type: 'String', required: true },
                    { name: 'category', type: 'String', required: false },
                    { name: 'riskLevel', type: 'Enum', values: ['LOW', 'MEDIUM', 'HIGH'] }
                ],
                relationships: [
                    '← PARTICIPATES_IN - Team (one-to-many)'
                ],
                indexes: ['id', 'name'],
                constraints: ['UNIQUE(id)', 'UNIQUE(name)']
            },
            injury: {
                title: 'Injury Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'bodyPart', type: 'String', required: true },
                    { name: 'injuryType', type: 'String', required: true },
                    { name: 'severity', type: 'Enum', values: ['MILD', 'MODERATE', 'SEVERE'] },
                    { name: 'description', type: 'String', required: false },
                    { name: 'painLevel', type: 'Integer', required: true, range: '1-10' },
                    { name: 'occurredAt', type: 'DateTime', required: true },
                    { name: 'reportedAt', type: 'DateTime', required: true },
                    { name: 'resolvedAt', type: 'DateTime', required: false },
                    { name: 'isResolved', type: 'Boolean', default: false }
                ],
                relationships: [
                    '← HAS_INJURY - Player (many-to-one)'
                ],
                indexes: ['id', 'occurredAt'],
                constraints: ['UNIQUE(id)']
            },
            status: {
                title: 'StatusUpdate Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'status', type: 'Enum', required: true, values: ['GREEN', 'ORANGE', 'RED'] },
                    { name: 'date', type: 'DateTime', required: true },
                    { name: 'painLevel', type: 'Integer', required: false, range: '0-10' },
                    { name: 'notes', type: 'String', required: false }
                ],
                relationships: [
                    '← HAD_STATUS - Player (many-to-one)'
                ],
                indexes: ['id', 'date'],
                constraints: ['UNIQUE(id)']
            },
            organization: {
                title: 'Organization Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'name', type: 'String', required: true },
                    { name: 'location', type: 'String', required: false },
                    { name: 'createdAt', type: 'DateTime', required: true }
                ],
                relationships: [
                    'EMPLOYS → Player (one-to-many)',
                    'EMPLOYS → Coach (one-to-many)',
                    'OWNS → Team (one-to-many)',
                    '← ADMINISTERS - Admin (many-to-one)'
                ],
                indexes: ['id', 'name'],
                constraints: ['UNIQUE(id)', 'UNIQUE(name)']
            },
            admin: {
                title: 'Admin Node',
                properties: [
                    { name: 'id', type: 'UUID', required: true, unique: true },
                    { name: 'name', type: 'String', required: true },
                    { name: 'email', type: 'String', required: true, unique: true },
                    { name: 'passwordHash', type: 'String', required: true },
                    { name: 'role', type: 'Enum', values: ['SUPER_ADMIN', 'ORG_ADMIN'] },
                    { name: 'createdAt', type: 'DateTime', required: true }
                ],
                relationships: [
                    'ADMINISTERS → Organization (many-to-one)'
                ],
                indexes: ['id', 'email'],
                constraints: ['UNIQUE(id)', 'UNIQUE(email)']
            }
        };

        function showInfo(nodeType) {
            const data = nodeData[nodeType];
            const panel = document.getElementById('infoPanel');
            
            let html = `
                <div class="info-title">${data.title}</div>
                
                <div class="info-section">
                    <div class="info-section-title">Properties</div>
                    ${data.properties.map(prop => `
                        <div class="property-item">
                            <span class="property-name">${prop.name}</span>: 
                            <span class="property-type">${prop.type}${prop.required ? ' (required)' : ''}${prop.unique ? ' (unique)' : ''}</span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">Relationships</div>
                    ${data.relationships.map(rel => `
                        <div class="property-item">${rel}</div>
                    `).join('')}
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">Indexes</div>
                    ${data.indexes.map(idx => `
                        <div class="property-item">INDEX ON :${data.title.replace(' Node', '')}(${idx})</div>
                    `).join('')}
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">Constraints</div>
                    ${data.constraints.map(con => `
                        <div class="property-item">${con}</div>
                    `).join('')}
                </div>
            `;
            
            panel.innerHTML = html;
            panel.classList.add('active');
        }
    </script>
</body>
</html>
